flowchart TD
    User[User/Script] -->|Open Session| ConnectorInterface
    ConnectorInterface -->|Open Tunnels| SshTunnelingManager
    SshTunnelingManager -->|Return Tunnel| ConnectorInterface
    ConnectorInterface -->|Pass Tunnel to Protocol| ProtocolHandler
    ProtocolHandler -->|Connect to Target| TargetSystem
    TargetSystem -->|Session Established| ConnectorInterface

    User -->|Execute Command| ConnectorInterface
    ConnectorInterface -->|Use Session| ProtocolHandler
    ProtocolHandler -->|Run Command| TargetSystem
    TargetSystem -->|Return Output| ProtocolHandler
    ProtocolHandler -->|Return Output| ConnectorInterface
    ConnectorInterface -->|Output to User| User

    User -->|Close Session| ConnectorInterface
    ConnectorInterface -->|Close Tunnels| SshTunnelingManager
    ConnectorInterface -->|Cleanup Session| ProtocolHandler